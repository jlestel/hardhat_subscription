const { expect } = require("chai");
const hre = require("hardhat");

describe("Tchat", function () {
  it("Should return the new tchat once it's changed", async function () {

    await hre.run('compile');
    const Contract = await hre.ethers.getContractFactory("Tchat");
    const tchat = await Contract.deploy();  //"Hello, world!"
    await tchat.deployed();
    console.log("Tchat deployed to:", tchat.address);

    const dest = "0x2E5CA01422E48076150B0e7f126ab48E97Ee09Ac"
    const msg = "yoyo"
    await tchat.addMessage(msg, dest)
    const messages = await tchat.getMessages()

    expect(messages.length).to.equal(1);

    expect(messages[0].recipient).to.equal(dest);
    expect(messages[0].message).to.equal(msg);

    //const setGreetingTx = await greeter.setGreeting("Hola, mundo!");

    // wait until the transaction is mined
    //await setGreetingTx.wait();
  });
});
